#!/usr/bin/env bash

symlink() {
  echo "- Symlink $2 -> $1"
  ln -s "$1" "$2"
}

# Install zsh
if command -v brew &> /dev/null; then
  brew install zsh zsh-completions
elif command -v apt-get &> /dev/null; then
  apt-get install zsh
fi

# Add zsh to valid login shells
grep -q $(command -v zsh) /etc/shells || sudo sh -c "echo $(command -v zsh) >> /etc/shells"

# Set zsh as default shell
if [ $(command -v zsh) != $SHELL ]; then
  sudo chsh -s $(command -v zsh) $(whoami)
fi

# Install oh-my-zsh syntax highlighting
if [ ! -d ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting ]; then
  git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting
fi

# "Install" dotfiles that have not already been installed
cd $(dirname "$0")
for f in .*; do
  if [ -f "$f" ]; then
    ln -sfv "$(pwd)/$f" "$HOME/$f"
  fi
done

# Install and use Vundle (Vim plugin manager)
if [ ! -d ~/.vim/bundle/Vundle.vim ]; then
  git clone https://github.com/VundleVim/Vundle.vim.git ~/.vim/bundle/Vundle.vim
fi
vim +PluginInstall! +qall
