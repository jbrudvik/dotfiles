#!/usr/bin/env bash

# Set PATH: Prioritize local over global
export PATH="/usr/local/bin:$PATH"
export PATH="$HOME/.local/bin:$PATH"
export PATH="$HOME/bin:$PATH"

# Add dotfiles directory to PATH
REALPATH=$([ -L "$0" ] && readlink "$0")
REALDIR=$(dirname "$REALPATH")
export PATH="$REALDIR:$PATH"

# Initialize Homebrew
command -v /opt/homebrew/bin/brew >/dev/null && eval "$(/opt/homebrew/bin/brew shellenv)"

# Default editor used by other programs
if command -v hx >/dev/null; then
	export EDITOR='hx'
else
	export EDITOR='vim'
fi

# broot file browser
source "$HOME/.config/broot/launcher/bash/br" 2>/dev/null

# Rust
source ~/.cargo/env

# Go
if [ "$(uname -s)" = "Darwin" ]; then
	export GOOS=darwin
	export GOARCH=arm64
	if command -v go >/dev/null; then
		GOPATH=$(go env GOPATH)
		export PATH="$GOPATH/bin:$GOPATH/bin/${GOOS}_${GOARCH}:$PATH"
	else
		export PATH=$PATH:/usr/local/go/bin
	fi
else
	export PATH=$PATH:"$HOME/.go/bin"
	export GOPATH="$HOME/go"
	export PATH=$PATH:"$HOME/go/bin"
fi

# n + Node/npm
export N_PREFIX=$HOME/.n
export PATH="$HOME/.n/bin:$PATH"

# Python
# Initialize pyenv (if it exists)
command -v pyenv >/dev/null && eval "$(pyenv init -)"
export PATH="$HOME/.pyenv/shims:$PATH"
# Set PYTHON: Pointer to global Python install
PYTHON=$(command -v python)
export PYTHON
# Python: Poetry
export PATH="$HOME/.poetry/bin:$PATH"

# Aliases
if [ -f "$HOME/.bash_aliases" ]; then
	source "$HOME/.bash_aliases"
fi

# Local settings
if [ -f "$HOME/.bash_local" ]; then
	source "$HOME/.bash_local"
fi
